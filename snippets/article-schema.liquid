<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "@id": "{{ article.url | absolute_url }}#blogposting",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ article.url | absolute_url }}"
    },
    "headline": "{{ article.title | escape }}",
    "name": "{{ article.title | escape }}",
    "description": "{{ article.excerpt_or_content | strip_html | truncatewords: 150 | escape }}",
    "image": [
      "{{ article.image | img_url: 'master' }}",
      "{{ article.image | img_url: '1200x' }}",
      "{{ article.image | img_url: '600x' }}"
    ],
    "isPartOf": {
      "@type": "Blog",
      "name": "{{ blog.title | escape }}",
      "url": "{{ blog.url | absolute_url }}"
    },
    "author": {
      "@type": "Person",
      "name": "{{ article.author | escape }}"
    },
    "publisher": {
      "@type": "Organization",
      "name": "{{ shop.name | escape }}",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.chargul.com/cdn/shop/files/chargul-logo.webp?v=1719941904",
        "width": 200,
        "height": 60
      }
    },
    "datePublished": "{{ article.published_at | date: '%Y-%m-%d' }}",
    "dateModified": "{{ article.updated_at | date: '%Y-%m-%d' }}",
    {% if article.tags.size > 0 %}
      "keywords": "{{ article.tags | join: ', ' | escape }}",
    {% endif %}
    {% if blog.title %}
      "articleSection": "{{ blog.title | escape }}",
    {% endif %}
    "wordCount": {{ article.content | strip_html | split: ' ' | size }},
    "timeRequired": "PT{{ article.content | strip_html | split: ' ' | size | divided_by: 200 | round }}M",
    "mainEntity": {
      "@type": "ItemList",
      "itemListElement": [
        {% assign parts = article.content | split: '<h2>' %}
        {% assign has_parts = false %}
        {% for part in parts %}
          {% if forloop.first %}
            {% assign paragraphs = part | split: '</p>' %}
            {% for paragraph in paragraphs %}
              {% assign clean_paragraph = paragraph | strip_html | strip | replace: '\n', '' %}
              {% if clean_paragraph != '' %}
                {% if has_parts %},{% endif %}
                {
                  "@type": "ListItem",
                  "position": {{ forloop.index }},
                  "item": {
                    "@type": "WebPageElement",
                    "text": "{{ clean_paragraph | escape }}"
                  }
                }
                {% assign has_parts = true %}
              {% endif %}
            {% endfor %}
          {% else %}
            {% assign sub_parts = part | split: '</h2>' %}
            {% assign heading = sub_parts[0] | strip_html | strip | replace: '\n', '' %}
            {% assign paragraphs = sub_parts[1] | split: '</p>' %}
            {% if has_parts %},{% endif %}
            {
              "@type": "ListItem",
              "position": {{ forloop.index }},
              "item": {
                "@type": "WebPageElement",
                "name": "{{ heading | escape }}",
                "text": "{% for paragraph in paragraphs %}{% assign clean_paragraph = paragraph | strip_html | strip | replace: '\n', '' %}{% if clean_paragraph != '' %}{{ clean_paragraph | escape }} {% endif %}{% endfor %}"
              }
            }
            {% assign has_parts = true %}
          {% endif %}
        {% endfor %}
      ]
    },
    "hasPart": [
      {
        "@type": "WebPageElement",
        "name": "Article Header",
        "description": "Title, author, and publication date of the article"
      },
      {
        "@type": "WebPageElement",
        "name": "Article Image",
        "description": "Main image of the article",
        "image": "{{ article.image | img_url: 'master' }}"
      },
      {
        "@type": "WebPageElement",
        "name": "Article Content",
        "description": "Main body of the article including text and images"
      },
      {
        "@type": "WebPageElement",
        "name": "Comments Section",
        "description": "Reader comments and discussion area"
      },
      {
        "@type": "WebPageElement",
        "name": "Newly Curated Rugs",
        "description": "A selection of our latest Afghan rugs available for purchase."
      }
    ]
  }
  </script>