{%- liquid
	
	assign sizes = '320x0,920x0'
	if input_sizes
	  assign sizes = input_sizes
	endif
	
	assign image_sizes = sizes | split: ","
  
	if priority
	  assign fetchpriority = 'high'
	  assign loading = 'eager'
	else
	  assign fetchpriority = 'auto'
	  assign loading = 'lazy'
	endif
  
	assign first_size = image_sizes | first | split: 'x'
	assign first_width = first_size[0] | plus: 0
	assign first_height = first_size[1] | plus: 0
	if first_height == 0
	  assign first_height = first_width | divided_by: image.aspect_ratio | round
	endif
  -%}
  <style>
	.image-wrapper {
	  position: relative;
	  overflow: hidden;
	}
	.image-wrapper img {
	  position: absolute;
	  top: 0;
	  left: 0;
	  width: 100%;
	  height: 100%;
	  object-fit: cover;
	}
	.image-wrapper .blur {
	  filter: blur(10px);
	  transform: scale(1.1);
	}
  </style>
  <div class="image-wrapper {{ class | escape }}{% if retina %} retina_size{% endif %}" style="width: {{ w }}px; height: {{ h }}px;">
	<img
		class="blur"
		width="{{ w }}"
		height="{{ h }}"
		src="{{ image | image_url: width: 50, height: 50, crop: 'center' }}"
		alt=""
		aria-hidden="true"
	  >
	<img
	  width="{{ w }}"
	  height="{{ h }}"
	  src="{{ image | image_url: width: first_width, height: first_height, crop: 'center' }}"
	  srcset="
		{%- for size in image_sizes -%}
		  {%- assign size_array = size | split: 'x' -%}
		  {%- assign width = size_array[0] | plus: 0 -%}
		  {%- assign height = size_array[1] | plus: 0 -%}
		  {%- if height == 0 -%}
			{%- assign height = width | divided_by: image.aspect_ratio | round -%}
		  {%- endif -%}
		  {%- assign height = height | at_least: 1 | at_most: 5760 -%}
		  {%- assign mobile_width = width | times: 0.5 | round -%}
		  {%- assign mobile_height = height | times: 0.5 | round -%}
		  {%- assign mobile_height = mobile_height | at_least: 1 | at_most: 5760 -%}
		  {{ image | image_url: width: width, height: height, crop: 'center', quality: 80 }} {{ width }}w,
		  {{ image | image_url: width: mobile_width, height: mobile_height, crop: 'center', quality: 80 }} {{ mobile_width }}w
		  {%- unless forloop.last -%}, {%- endunless -%}
		{%- endfor -%}
	  "
	  sizes="(max-width: 767px) 50vw, 100vw"
	  fetchpriority="{{ fetchpriority }}"
	  loading="{{ loading }}"
	  alt="{{ image.alt | escape }}"
	  {% if focal_point -%}style="object-position: {{ focal_point }};"{% endif %}
	>
  </div>