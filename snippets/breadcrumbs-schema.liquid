<script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "item": {
            "@id": "{{ routes.root_url }}",
            "name": "{{ 'breadcrumbs.home' | t }}"
          }
        }
        {% if template contains 'product' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ routes.collections_url }}/afghan-rugs",
            "name": "{{ 'breadcrumbs.shop' | t }}"
          }
        }
        {% assign breadcrumb_handle = product.metafields.custom.breadcrumb %}
        {% if breadcrumb_handle != blank %}
        ,{
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@id": "{{ routes.collections_url }}/{{ breadcrumb_handle | handle }}",
            "name": "{{ breadcrumb_handle }}"
          }
        }
        ,{
          "@type": "ListItem",
          "position": 4,
          "item": {
            "@id": "{{ product.url }}",
            "name": "{{ product.title }}"
          }
        }
        {% elsif collection.url %}
        ,{
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@id": "{{ collection.url }}",
            "name": "{{ collection.title }}"
          }
        }
        ,{
          "@type": "ListItem",
          "position": 4,
          "item": {
            "@id": "{{ product.url }}",
            "name": "{{ product.title }}"
          }
        }
        {% else %}
        ,{
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@id": "{{ product.url }}",
            "name": "{{ product.title }}"
          }
        }
        {% endif %}
        {% elsif collection.url %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ routes.collections_url }}/afghan-rugs",
            "name": "{{ 'breadcrumbs.shop' | t }}"
          }
        }
        {% unless collection.handle == 'afghan-rugs' %}
        ,{
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@id": "{{ collection.url }}",
            "name": "{{ collection.title }}"
          }
        }
        {% endunless %}
        {% elsif template contains 'cart' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ routes.cart_url }}",
            "name": "{{ 'breadcrumbs.cart' | t }}"
          }
        }
        {% elsif template contains 'blog' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ blog.url }}",
            "name": "{{ blog.title }}"
          }
        }
        {% if current_tags %}
        ,{
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@id": "{{ blog.url }}/tagged/{{ current_tags | join: '+' }}",
            "name": "{{ current_tags | join: ', ' }}"
          }
        }
        {% endif %}
        {% elsif template contains 'article' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ blog.url }}",
            "name": "{{ blog.title }}"
          }
        }
        ,{
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@id": "{{ article.url }}",
            "name": "{{ article.title }}"
          }
        }
        {% elsif template contains 'page' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ page.url }}",
            "name": "{{ page.title }}"
          }
        }
        {% elsif template contains 'search' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ routes.search_url }}",
            "name": "{{ 'breadcrumbs.search' | t }}"
          }
        }
        {% elsif template contains 'customers' %}
        ,{
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@id": "{{ routes.account_url }}",
            "name": "{{ 'breadcrumbs.my_account' | t }}"
          }
        }
        {% endif %}
      ]
    }
    </script>