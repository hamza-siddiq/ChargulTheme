<script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "WebPage",
    "mainEntity": {
      "@type": "Product",
      "@id": "{{ shop.url }}{{ product.url }}#product",
      "name": "{{ product.title }}",
      "image": [
        {% for image in product.images %}
          "https:{{ image.src | img_url: 'master' }}"{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ],
      "description": {
        "@type": "ItemList",
        "itemListElement": [
          {% assign parts = product.content | split: '<h3' %}
          {% for part in parts %}
            {% if forloop.first %}
              {% assign paragraphs = part | split: '</p>' %}
              {% for paragraph in paragraphs %}
                {% assign clean_paragraph = paragraph | strip_html | strip_newlines | replace: '\n', '' %}
                {% if clean_paragraph != '' %}
                  {% if forloop.index0 > 1 %},{% endif %}
                  {
                    "@type": "ListItem",
                    "position": {{ forloop.index }},
                    "item": {
                      "@type": "WebPageElement",
                      "text": "{{ clean_paragraph | escape }}"
                    }
                  }
                {% endif %}
              {% endfor %}
            {% else %}
              {% assign sub_parts = part | split: '</h3>' %}
              {% assign heading = sub_parts[0] | strip_html | strip_newlines | replace: 'style="font-size: calc(var(--font-heading-scale) * 15px); display: inline; line-height: 1.7; font-family: Chivo, sans-serif; margin-bottom: 0px;">', '' | replace: 'data-mce-style="font-size: calc(var(--font-heading-scale) * 15px); display: inline; line-height: 1.7; font-family: Chivo, sans-serif; margin-bottom: 0px;"', '' | strip %}
              {% assign paragraphs = sub_parts[1] | split: '</p>' %}
              {% if forloop.index0 > 1 %},{% endif %}
              {
                "@type": "ListItem",
                "position": {{ forloop.index }},
                "item": {
                  "@type": "WebPageElement",
                  "name": "{{ heading | escape }}",
                  "text": "{% for paragraph in paragraphs %}{% assign clean_paragraph = paragraph | strip_html | strip_newlines | replace: '\n', '' | replace: '&amp;', '&' | replace: '&gt;', '>' | replace: '&lt;', '<' | replace: '&quot;', '\"' %}{% if clean_paragraph != '' %}{{ clean_paragraph | escape }} {% endif %}{% endfor %}"
                }
              }
            {% endif %}
          {% endfor %}
        ]
      }
    },
    "isPartOf": {
      "@type": "WebPage",
      "name": "Chargul Afghan Rugs Collection",
      "url": "{{ shop.url }}/collections/afghan-rugs"
    },
    "hasPart": [
      {
        "@type": "WebPageElement",
        "name": "Product Information",
        "@id": "{{ shop.url }}{{ product.url }}#product-information",
        "description": "Information about the products unique selling points featuring the product "
      },
      {
        "@type": "WebPageElement",
        "name": "Complementary Products",
        "description": "Section showcasing related or complementary products"
      },
      {
        "@type": "WebPageElement",
        "name": "Handcrafted Wonders",
        "description": "Information about the craftsmanship of Afghan rugs"
      },
      {
        "@type": "WebPageElement",
        "name": "The Journey of Chargul's Afghan Rugs",
        "description": "Story of how the rugs are made and delivered"
      },
      {
        "@type": "WebPageElement",
        "name": "Timeless Beauty, Unmatched Quality",
        "description": "Overview of the rug collection's qualities"
      },
      {
        "@type": "WebPageElement",
        "name": "The Enchantment of an Afghan Rug",
        "description": "Poetic description of the allure of Afghan rugs"
      },
      {
        "@type": "WebPageElement",
        "name": "Discover Curated Rugs",
        "description": "Gallery of other available rugs"
      }
    ],
    "about": {
      "@type": "Product",
      "sku": "{{ product.selected_or_first_available_variant.sku }}",
      "brand": {
        "@type": "Brand",
        "name": "Chargul"
      },
      "offers": {
        "@type": "Offer",
        "url": "{{ shop.url }}{{ product.url }}",
        "priceCurrency": "{{ shop.currency }}",
        "price": "{{ product.price | money_without_currency }}",
        "availability": "{% if product.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
        "itemCondition": "https://schema.org/NewCondition"
      },
      "additionalProperty": [
        {
          "@type": "PropertyValue",
          "name": "Material",
          "value": "Pure Wool"
        },
        {
          "@type": "PropertyValue",
          "name": "Construction",
          "value": "Hand-Knotted"
        },
        {
          "@type": "PropertyValue",
          "name": "Origin",
          "value": "Afghanistan"
        },
        {
          "@type": "PropertyValue",
          "name": "Dimensions",
          "value": "{{ product.selected_or_first_available_variant.option1 }}"
        }
      ],
      "width": {
        "@type": "QuantitativeValue",
        "value": "{{ product.selected_or_first_available_variant.width }}",
        "unitCode": "CMT"
      },
      "height": {
        "@type": "QuantitativeValue",
        "value": "{{ product.selected_or_first_available_variant.height }}",
        "unitCode": "CMT"
      },
      "weight": {
        "@type": "QuantitativeValue",
        "value": "{{ product.selected_or_first_available_variant.weight }}",
        "unitCode": "KGM"
      }
    }
  }
  </script>
  