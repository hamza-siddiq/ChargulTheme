{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ canonical_url }}"
  },
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ shop.name }}",
    "url": "{{ shop.url }}"
  },
  "name": "{{ collection.title | escape }}",
  "description": "{{ collection.description | strip_html | newline_to_br | strip_newlines | replace: '<br />', ' : ' | truncate: 150 | default: "Available: All Sizes"}}",
  "image": "{{ collection.image | img_url: 'large' }}",
  "offers": {
    "@type": "AggregateOffer",
    "offerCount": "{{ collection.products_count }}",
    "lowPrice": "{{ collection.products | map: 'price' | sort | first | money_without_currency | remove: ',' }}",
    "highPrice": "{{ collection.products | map: 'price' | sort | last | money_without_currency | remove: ',' }}",
    "priceCurrency": "{{ shop.currency }}"
  },
  "numberOfItems": {{ collection.products_count }},
  "hasPart": [
    {
      "@type": "WebPageElement",
      "name": "Hero Image",
      "description": "A large banner image showcasing featured Afghan rugs from the collection",
      "image": "{{ collection.featured_image }}"
    },
    {
      "@type": "WebPageElement",
      "name": "Product Grid",
      "description": "Grid display of Afghan rugs available in this collection.",
      "itemListElement": [
        {% for product in collection.products limit:10 %}
        {
          "@type": "Product",
          "name": {{ product.title | json }},
          "image": "{{ product.featured_image | img_url: 'large' }}",
          "offers": {
            "@type": "Offer",
            "price": "{{ product.price | money_without_currency | remove: ',' }}",
            "priceCurrency": "{{ shop.currency }}"
          }
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    },
    {
      "@type": "WebPageElement",
      "name": "Shopping Information",
      "description": "Detailed information about Afghan rugs, custom options, shipping, and return policies."
    },
    {
      "@type": "WebPageElement",
      "name": "Blog Posts",
      "description": "Learn more about the art of Afghan Rugs through our blog posts."
    }
  ]
}